nohup: ignoring input
Running on cpu
Os: Ubuntu
_MODEL ['SGFN', 'SGPN']
dict:MODEL
  N_LAYERS 2
  USE_SPATIAL False
  WITH_BN False
  USE_GCN True
  USE_RGB False
  USE_NORMAL False
  USE_CONTEXT True
  USE_GCN_EDGE True
  USE_REL_LOSS True
  OBJ_PRED_FROM_GCN True
  _GCN_TYPE ['TRIP', 'EAN', 'EAN_ms', 'EXP']
  GCN_TYPE TRIP
  _ATTENTION ['fat']
  ATTENTION fat
  DROP_OUT_ATTEN 0.5
  multi_rel_outputs True
  feature_transform False
  point_feature_size 256
  edge_feature_size 256
  gcn_hidden_feature_size 512
  lambda_o 0.1
  NUM_HEADS 4
  _GCN_AGGR ['add', 'mean', 'max']
  GCN_AGGR max
  DIM_ATTEN 256
  _WEIGHT_EDGE ['BG', 'DYNAMIC', 'OCCU']
  WEIGHT_EDGE DYNAMIC
  w_bg 1.0
  NONE_RATIO 1.0
VERBOSE True
SEED 2020
MAX_EPOCHES 200
LR 0.001
W_DECAY False
AMSGRAD False
_LR_SCHEDULE ['None', 'BatchSize']
LR_SCHEDULE None
GPU [0]
SAVE_INTERVAL 100
VALID_INTERVAL 5
LOG_INTERVAL 10
LOG_IMG_INTERVAL 100
WORKERS 0
_EDGE_BUILD_TYPE ['FC', 'KNN']
EDGE_BUILD_TYPE KNN
WEIGHTING True
dict:dataset
  root ['./gen_data/']
  selection 
  ignore_scannet_rel True
  is_v2 True
  _label_file ['labels.instances.align.annotated.v2.ply', 'inseg.ply', 'cvvseg.ply']
  label_file labels.instances.align.annotated.v2.ply
  data_augmentation False
  num_points 128
  num_points_union 256
  disable_support_rel False
  with_bbox False
  discard_some False
  _dataset_type ['SGPN', 'SGFN']
  dataset_type SGPN
  load_cache False
  sample_in_runtime True
  sample_num_nn 2
  sample_num_seed 4
  class_choice []
  max_edges -1
  drop_edge 0.5
  drop_edge_eval 0.0
PATH /media/sdb/FabiolaPasini/Scene-Graph-Master-Thesis/SGPN
DEVICE cpu
NAME SGPN
LOADBEST 0
MODE train

build train dataset
build rio_graph dataset
=== 160 classes ===
| 0             armchair:0.149|| 1             backpack:0.185|
| 2                  bag:0.147|| 3                 ball:0.275|
| 4                  bar:0.270|| 5                basin:0.358|
| 6               basket:0.160|| 7         bath cabinet:0.179|
| 8              bathtub:0.211|| 9                  bed:0.161|
|10        bedside table:0.224||11                bench:0.168|
|12                bidet:0.358||13                  bin:0.205|
|14              blanket:0.155||15               blinds:0.170|
|16                board:0.261||17                 book:0.222|
|18                books:0.239||19            bookshelf:0.233|
|20               bottle:0.204||21                  box:0.128|
|22                bread:0.358||23               bucket:0.179|
|24              cabinet:0.143||25               carpet:0.235|
|26              ceiling:0.129||27                chair:0.119|
|28             cleanser:0.477||29                clock:0.227|
|30               closet:0.242||31              clothes:0.150|
|32        clothes dryer:0.199||33              clutter:0.177|
|34       coffee machine:0.242||35         coffee table:0.173|
|36              commode:0.163||37        computer desk:0.339|
|38                couch:0.196||39          couch table:0.206|
|40              counter:0.187||41                  cup:0.383|
|42             cupboard:0.210||43              curtain:0.137|
|44              cushion:0.162||45        cutting board:0.244|
|46           decoration:0.189||47                 desk:0.160|
|48         dining chair:0.200||49         dining table:0.217|
|50                 door:0.135||51            doorframe:0.153|
|52               drawer:0.231||53                 drum:0.591|
|54       drying machine:0.281||55        extractor fan:0.477|
|56            fireplace:0.281||57                floor:0.127|
|58               flower:0.242||59              flowers:0.235|
|60               folder:0.313||61                 food:0.325|
|62            footstool:0.419||63                frame:0.185|
|64          fruit plate:1.000||65              garbage:0.224|
|66          garbage bin:0.275||67                grass:0.000|
|68           hand dryer:0.383||69               heater:0.155|
|70                 item:0.138||71               jacket:0.000|
|72                  jar:0.339||73               kettle:0.221|
|74    kitchen appliance:0.190||75      kitchen cabinet:0.154|
|76      kitchen counter:0.183||77         kitchen hood:0.358|
|78               ladder:0.275||79                 lamp:0.137|
|80               laptop:0.208||81       laundry basket:0.239|
|82                light:0.148||83              machine:0.325|
|84        magazine rack:0.591||85                 menu:1.000|
|86            microwave:0.198||87               mirror:0.181|
|88              monitor:0.156||89              napkins:0.303|
|90           nightstand:0.174||91               object:0.138|
|92              objects:0.270||93            organizer:0.227|
|94              ottoman:0.229||95                 oven:0.204|
|96                 pack:0.250||97                  pan:0.325|
|98          paper towel:0.254||99               papers:0.419|
|100                   pc:0.182||101              picture:0.142|
|102        pile of books:0.313||103       pile of papers:0.000|
|104               pillow:0.125||105                 pipe:0.213|
|106                plant:0.134||107                plate:0.212|
|108               player:0.477||109                  pot:0.216|
|110              printer:0.216||111                 rack:0.186|
|112             radiator:0.172||113          recycle bin:0.261|
|114         refrigerator:0.198||115        rocking chair:0.477|
|116                scale:0.250||117               screen:0.591|
|118                shelf:0.127||119                 shoe:0.383|
|120            shoe rack:0.591||121                shoes:0.191|
|122             showcase:0.207||123               shower:0.217|
|124       shower curtain:0.211||125         shower floor:0.313|
|126          shower wall:0.250||127           side table:0.209|
|128                 sink:0.154||129            soap dish:0.477|
|130               socket:0.383||131                 sofa:0.166|
|132           sofa chair:0.303||133                stair:0.325|
|134                stand:0.178||135                stool:0.157|
|136                stove:0.197||137       stuffed animal:0.242|
|138             suitcase:0.209||139                table:0.135|
|140           table lamp:0.233||141            telephone:0.218|
|142              toaster:0.339||143               toilet:0.179|
|144         toilet brush:0.222||145         toilet paper:0.211|
|146 toilet paper dispenser:0.294||147                towel:0.154|
|148            trash can:0.155||149             trashcan:0.358|
|150                 tube:0.270||151                   tv:0.169|
|152             tv stand:0.200||153                 vase:0.209|
|154                 wall:0.108||155             wardrobe:0.163|
|156      washing machine:0.193||157       washing powder:0.339|
|158               window:0.134||159           windowsill:0.158|

=== 7 relationships ===
| 0          attached to 0.099|| 1             build in 0.153|
| 2         connected to 0.154|| 3           hanging on 0.118|
| 4              part of 0.185|| 5          standing on 0.099|
| 6         supported by 0.127|
num of data: 945
build valid dataset
build rio_graph dataset
=== 160 classes ===
| 0             armchair:0.218|| 1             backpack:0.239|
| 2                  bag:0.183|| 3                 ball:0.000|
| 4                  bar:0.287|| 5                basin:0.000|
| 6               basket:0.221|| 7         bath cabinet:0.221|
| 8              bathtub:0.287|| 9                  bed:0.208|
|10        bedside table:0.000||11                bench:0.212|
|12                bidet:0.477||13                  bin:0.339|
|14              blanket:0.206||15               blinds:0.275|
|16                board:0.358||17                 book:0.325|
|18                books:1.000||19            bookshelf:0.477|
|20               bottle:0.339||21                  box:0.139|
|22                bread:0.000||23               bucket:0.220|
|24              cabinet:0.190||25               carpet:0.383|
|26              ceiling:0.156||27                chair:0.144|
|28             cleanser:0.000||29                clock:0.325|
|30               closet:0.000||31              clothes:0.193|
|32        clothes dryer:0.287||33              clutter:0.261|
|34       coffee machine:0.591||35         coffee table:0.247|
|36              commode:0.191||37        computer desk:0.000|
|38                couch:0.250||39          couch table:0.477|
|40              counter:0.257||41                  cup:1.000|
|42             cupboard:0.325||43              curtain:0.175|
|44              cushion:0.239||45        cutting board:0.419|
|46           decoration:0.244||47                 desk:0.199|
|48         dining chair:0.000||49         dining table:0.591|
|50                 door:0.166||51            doorframe:0.189|
|52               drawer:0.383||53                 drum:0.000|
|54       drying machine:0.000||55        extractor fan:0.419|
|56            fireplace:0.383||57                floor:0.155|
|58               flower:0.281||59              flowers:0.000|
|60               folder:0.000||61                 food:0.591|
|62            footstool:0.000||63                frame:0.591|
|64          fruit plate:0.000||65              garbage:0.383|
|66          garbage bin:0.325||67                grass:0.477|
|68           hand dryer:0.303||69               heater:0.208|
|70                 item:0.160||71               jacket:1.000|
|72                  jar:0.325||73               kettle:0.325|
|74    kitchen appliance:0.287||75      kitchen cabinet:0.183|
|76      kitchen counter:0.217||77         kitchen hood:0.591|
|78               ladder:0.477||79                 lamp:0.166|
|80               laptop:0.294||81       laundry basket:0.313|
|82                light:0.206||83              machine:0.000|
|84        magazine rack:0.000||85                 menu:0.000|
|86            microwave:0.325||87               mirror:0.231|
|88              monitor:0.247||89              napkins:0.383|
|90           nightstand:0.213||91               object:0.199|
|92              objects:0.419||93            organizer:0.339|
|94              ottoman:0.313||95                 oven:0.242|
|96                 pack:0.265||97                  pan:0.419|
|98          paper towel:0.591||99               papers:0.591|
|100                   pc:0.358||101              picture:0.187|
|102        pile of books:0.477||103       pile of papers:0.419|
|104               pillow:0.153||105                 pipe:0.358|
|106                plant:0.160||107                plate:0.313|
|108               player:0.419||109                  pot:0.000|
|110              printer:0.419||111                 rack:0.247|
|112             radiator:0.244||113          recycle bin:0.000|
|114         refrigerator:0.265||115        rocking chair:0.000|
|116                scale:0.591||117               screen:0.000|
|118                shelf:0.147||119                 shoe:0.000|
|120            shoe rack:0.591||121                shoes:0.244|
|122             showcase:0.287||123               shower:0.313|
|124       shower curtain:0.591||125         shower floor:0.000|
|126          shower wall:0.383||127           side table:0.270|
|128                 sink:0.190||129            soap dish:0.000|
|130               socket:0.591||131                 sofa:0.199|
|132           sofa chair:0.281||133                stair:0.383|
|134                stand:0.265||135                stool:0.185|
|136                stove:0.239||137       stuffed animal:0.339|
|138             suitcase:0.294||139                table:0.163|
|140           table lamp:0.419||141            telephone:0.265|
|142              toaster:0.000||143               toilet:0.229|
|144         toilet brush:0.383||145         toilet paper:0.287|
|146 toilet paper dispenser:0.000||147                towel:0.193|
|148            trash can:0.200||149             trashcan:0.000|
|150                 tube:0.287||151                   tv:0.218|
|152             tv stand:0.250||153                 vase:0.265|
|154                 wall:0.124||155             wardrobe:0.193|
|156      washing machine:0.325||157       washing powder:0.000|
|158               window:0.168||159           windowsill:0.239|

=== 7 relationships ===
| 0          attached to 0.113|| 1             build in 0.177|
| 2         connected to 0.196|| 3           hanging on 0.145|
| 4              part of 0.226|| 5          standing on 0.114|
| 6         supported by 0.158|
num of data: 230
build test dataset
build rio_graph dataset
=== 160 classes ===
| 0             armchair:0.000|| 1             backpack:0.000|
| 2                  bag:0.000|| 3                 ball:0.000|
| 4                  bar:0.000|| 5                basin:0.000|
| 6               basket:0.000|| 7         bath cabinet:0.000|
| 8              bathtub:0.000|| 9                  bed:0.000|
|10        bedside table:0.000||11                bench:0.000|
|12                bidet:0.000||13                  bin:0.000|
|14              blanket:0.000||15               blinds:0.000|
|16                board:0.000||17                 book:0.000|
|18                books:0.000||19            bookshelf:0.000|
|20               bottle:0.000||21                  box:0.000|
|22                bread:0.000||23               bucket:0.000|
|24              cabinet:0.000||25               carpet:0.000|
|26              ceiling:0.000||27                chair:0.000|
|28             cleanser:0.000||29                clock:0.000|
|30               closet:0.000||31              clothes:0.000|
|32        clothes dryer:0.000||33              clutter:0.000|
|34       coffee machine:0.000||35         coffee table:0.000|
|36              commode:0.000||37        computer desk:0.000|
|38                couch:0.000||39          couch table:0.000|
|40              counter:0.000||41                  cup:0.000|
|42             cupboard:0.000||43              curtain:0.000|
|44              cushion:0.000||45        cutting board:0.000|
|46           decoration:0.000||47                 desk:0.000|
|48         dining chair:0.000||49         dining table:0.000|
|50                 door:0.000||51            doorframe:0.000|
|52               drawer:0.000||53                 drum:0.000|
|54       drying machine:0.000||55        extractor fan:0.000|
|56            fireplace:0.000||57                floor:0.000|
|58               flower:0.000||59              flowers:0.000|
|60               folder:0.000||61                 food:0.000|
|62            footstool:0.000||63                frame:0.000|
|64          fruit plate:0.000||65              garbage:0.000|
|66          garbage bin:0.000||67                grass:0.000|
|68           hand dryer:0.000||69               heater:0.000|
|70                 item:0.000||71               jacket:0.000|
|72                  jar:0.000||73               kettle:0.000|
|74    kitchen appliance:0.000||75      kitchen cabinet:0.000|
|76      kitchen counter:0.000||77         kitchen hood:0.000|
|78               ladder:0.000||79                 lamp:0.000|
|80               laptop:0.000||81       laundry basket:0.000|
|82                light:0.000||83              machine:0.000|
|84        magazine rack:0.000||85                 menu:0.000|
|86            microwave:0.000||87               mirror:0.000|
|88              monitor:0.000||89              napkins:0.000|
|90           nightstand:0.000||91               object:0.000|
|92              objects:0.000||93            organizer:0.000|
|94              ottoman:0.000||95                 oven:0.000|
|96                 pack:0.000||97                  pan:0.000|
|98          paper towel:0.000||99               papers:0.000|
|100                   pc:0.000||101              picture:0.000|
|102        pile of books:0.000||103       pile of papers:0.000|
|104               pillow:0.000||105                 pipe:0.000|
|106                plant:0.000||107                plate:0.000|
|108               player:0.000||109                  pot:0.000|
|110              printer:0.000||111                 rack:0.000|
|112             radiator:0.000||113          recycle bin:0.000|
|114         refrigerator:0.000||115        rocking chair:0.000|
|116                scale:0.000||117               screen:0.000|
|118                shelf:0.000||119                 shoe:0.000|
|120            shoe rack/home/fabiola/.conda/envs/scene_graph/lib/python3.8/site-packages/torch/cuda/__init__.py:52: UserWarning: CUDA initialization: The NVIDIA driver on your system is too old (found version 10010). Please update your GPU driver by downloading and installing a new version from the URL: http://www.nvidia.com/Download/index.aspx Alternatively, go to: https://pytorch.org to install a PyTorch version that has been compiled with your version of the CUDA driver. (Triggered internally at  /opt/conda/conda-bld/pytorch_1623448234945/work/c10/cuda/CUDAFunctions.cpp:115.)
  return torch._C._cuda_getDeviceCount() > 0
:0.000||121                shoes:0.000|
|122             showcase:0.000||123               shower:0.000|
|124       shower curtain:0.000||125         shower floor:0.000|
|126          shower wall:0.000||127           side table:0.000|
|128                 sink:0.000||129            soap dish:0.000|
|130               socket:0.000||131                 sofa:0.000|
|132           sofa chair:0.000||133                stair:0.000|
|134                stand:0.000||135                stool:0.000|
|136                stove:0.000||137       stuffed animal:0.000|
|138             suitcase:0.000||139                table:0.000|
|140           table lamp:0.000||141            telephone:0.000|
|142              toaster:0.000||143               toilet:0.000|
|144         toilet brush:0.000||145         toilet paper:0.000|
|146 toilet paper dispenser:0.000||147                towel:0.000|
|148            trash can:0.000||149             trashcan:0.000|
|150                 tube:0.000||151                   tv:0.000|
|152             tv stand:0.000||153                 vase:0.000|
|154                 wall:0.000||155             wardrobe:0.000|
|156      washing machine:0.000||157       washing powder:0.000|
|158               window:0.000||159           windowsill:0.000|

=== 7 relationships ===
| 0          attached to 0.000|| 1             build in 0.000|
| 2         connected to 0.000|| 3           hanging on 0.000|
| 4              part of 0.000|| 5          standing on 0.000|
| 6         supported by 0.000|
num of data: 0
cannot build eval dataset.
multi_rel_outputs
==trainable parameters==
Traceback (most recent call last):
  File "main.py", line 105, in <module>
    main()
  File "main.py", line 81, in main
    model = SGFN(config)                         
  File "/media/sdb/FabiolaPasini/Scene-Graph-Master-Thesis/src/SceneGraphFusionNetwork.py", line 74, in __init__
    self.model = SGPNModel(config, self.model_name, num_obj_class, num_rel_class).to(config.DEVICE)
  File "/media/sdb/FabiolaPasini/Scene-Graph-Master-Thesis/src/model_SGPN.py", line 145, in __init__
    print(name, src.op_utils.pytorch_count_params(model))
NameError: name 'src' is not defined
